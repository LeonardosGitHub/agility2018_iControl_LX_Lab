
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lab 4.2 - Updating the HelloWorld iControl LX Extension &#8212; Agility18 iControlLX Extensions Lab  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 4.3 - Create a New iControl LX Extension RPM" href="lab3.html" />
    <link rel="prev" title="Lab 4.1 - Creating the HelloWorld iControl LX Extension" href="lab1.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="lab-4-2-updating-the-helloworld-icontrol-lx-extension">
<h1>Lab 4.2 - Updating the HelloWorld iControl LX Extension<a class="headerlink" href="#lab-4-2-updating-the-helloworld-icontrol-lx-extension" title="Permalink to this headline">¶</a></h1>
<p>Now that we have an initial version of our extension up and running, let’s enhance it by adding the following capabilities:</p>
<ul class="simple">
<li>Handle <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests</li>
<li>Add logging information. Always useful to add logging information to track
behaviour and help troubleshooting any issue</li>
<li>Send a REST API call to a 3rd system</li>
</ul>
<div class="section" id="task-1-update-our-icontrol-lx-extension-handle-post-requests">
<h2>Task 1 - Update our iControl LX Extension - Handle POST Requests<a class="headerlink" href="#task-1-update-our-icontrol-lx-extension-handle-post-requests" title="Permalink to this headline">¶</a></h2>
<p>Here we will add code to our extension to handle <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests,
as well as add some troubleshooting statements.</p>
<p>The first thing we must do is enable our <code class="docutils literal notranslate"><span class="pre">f5-logger</span></code>. This will log messages to
<cite>/var/log/restnoded/restnoded.log</cite>.</p>
<p>Perform the following steps to complete this task:</p>
<ol class="arabic">
<li><p class="first">Execute <code class="docutils literal notranslate"><span class="pre">vi</span> <span class="pre">/var/config/rest/iapps/HelloWorld/nodejs/hello_world.js</span></code> to
edit the file.</p>
</li>
<li><p class="first">Below the first comment,</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/**</span>
 <span class="o">*</span> <span class="n">A</span> <span class="n">simple</span> <span class="n">iControl</span> <span class="n">LX</span> <span class="n">extension</span> <span class="n">that</span> <span class="n">handles</span> <span class="n">only</span> <span class="n">HTTP</span> <span class="n">GET</span>
 <span class="o">*/</span>
</pre></div>
</div>
<p>add the following: (<code class="docutils literal notranslate"><span class="pre">i,</span> <span class="pre">Paste,</span> <span class="pre">Enter</span></code> if you use <code class="docutils literal notranslate"><span class="pre">vi</span></code>)</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">logger</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;f5-logger&#39;</span><span class="p">).</span><span class="nx">getInstance</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">DEBUG</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Save the changes (<code class="docutils literal notranslate"><span class="pre">ESC</span> <span class="pre">ESC</span> <span class="pre">:w</span></code> if you use <code class="docutils literal notranslate"><span class="pre">vi</span></code>).</p>
</li>
<li><p class="first">Now we will be able to use the <code class="docutils literal notranslate"><span class="pre">logger</span></code> statement to print information to the
<cite>/var/log/restnoded/restnoded.log</cite> log file.  We can also enable/disable all
logging by changing the value of the DEBUG variable to false.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Here is an EXAMPLE of a logger statement (DO NOT PUT THIS INTO
YOUR CODE)</p>
<div class="last highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onGet request&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">We may also want to create a VARIABLE for our default JSON response of
<code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World!</span></code>. This way if we ever need to change it, we’ll only
need to change it in a single location.</p>
</li>
<li><p class="first">Under <code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">DEBUG</span> <span class="pre">=</span> <span class="pre">true;</span></code> add:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>
</pre></div>
</div>
<p>It should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;f5-logger&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInstance</span><span class="p">();</span>
<span class="n">var</span> <span class="n">DEBUG</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">var</span> <span class="n">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Next, let’s update your onGET prototype.  Right now you should have this:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onGet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span> <span class="p">}</span> <span class="p">));</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Replace this code with the following:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onGet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onGet request&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Here’s what we’ve done:</p>
<ul class="simple">
<li>Add a <code class="docutils literal notranslate"><span class="pre">logger</span></code> statement so that we can track when our extension is
called with a <code class="docutils literal notranslate"><span class="pre">GET</span></code> request</li>
<li>Replace our static response <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">value:</span> <span class="pre">&quot;Hello</span> <span class="pre">World!&quot;</span> <span class="pre">}</span></code> with our variable</li>
</ul>
</li>
<li><p class="first">Below our <code class="docutils literal notranslate"><span class="pre">onGet</span></code> prototype, we will now add an OnPost prototype to
handle <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests with our extension.</p>
<p>Add the following code below the <code class="docutils literal notranslate"><span class="pre">onGet</span></code> prototype:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">*handle onPost HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onPost</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">//we retrieve the payload sent with the POST request</span>
  <span class="kd">var</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">restOperation</span><span class="p">.</span><span class="nx">getBody</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost received Body is: &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">newState</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;\t&#39;</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="c1">//we extract the variable name from the payload</span>
  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">newState</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>

  <span class="c1">//if it&#39;s empty, we just print Hello World, otherwise Hello &lt;name&gt;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, the extracted name is : &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span><span class="p">}));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, no name parameter provided... using default value&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Let’s review the code we have now, it should look like this:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* A simple iControl LX extension that handles only HTTP GET</span>
<span class="cm">*/</span>

<span class="kd">var</span> <span class="nx">logger</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;f5-logger&#39;</span><span class="p">).</span><span class="nx">getInstance</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">DEBUG</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>

<span class="kd">function</span> <span class="nx">HelloWorld</span><span class="p">()</span> <span class="p">{}</span>

<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">WORKER_URI_PATH</span> <span class="o">=</span> <span class="s2">&quot;ilxe_lab/hello_world&quot;</span><span class="p">;</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isPublic</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm">* handle onGet HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onGet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onGet request&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm">*handle onPost HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onPost</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//we retrieve the payload sent with the POST request</span>
 <span class="kd">var</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">restOperation</span><span class="p">.</span><span class="nx">getBody</span><span class="p">();</span>

 <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost received Body is: &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">newState</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;\t&#39;</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="c1">//we extract the variable name from the payload</span>
  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">newState</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>

  <span class="c1">//if it&#39;s empty, we just print Hello World, otherwise Hello &lt;name&gt;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, the extracted name is : &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span><span class="p">}));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, no name parameter provided... using default value&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm">* handle /example HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getExampleState</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;your_string&quot;</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">HelloWorld</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li>The lines starting with <code class="docutils literal notranslate"><span class="pre">//</span></code> are comments. It’s always good to comment your code to help people read/understand your code… the
more code there is, the more important it is to provide properly commented
code.</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">newState</span> <span class="pre">=</span> <span class="pre">restOperation.getBody();</span></code> With this statement we
retrieve the PAYLOAD that was sent in the POST request and we show this
payload in the following logger command.</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">name</span> <span class="pre">=</span> <span class="pre">newState.name;</span></code> With this statement we assign the name parameter’s
value (sent with the POST request) to the name variable.</li>
<li>The following if/else statement determines whether the variable name is
empty or not (if the POST payload didn’t contain a name parameter) and
depending on this will do the following:<ul>
<li>If the variable name is not empty: reply to the <code class="docutils literal notranslate"><span class="pre">POST</span></code> request with
Hello and the name of the user</li>
<li>If the variable name is empty: reply to the <code class="docutils literal notranslate"><span class="pre">POST</span></code> request with
<code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World!</span></code></li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Make sure you save your updated file.</p>
</li>
<li><p class="first">Time to test our code!  Open another SSH session to the BIG-IP and run the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">bigstart</span> <span class="pre">restart</span> <span class="pre">restnoded</span> <span class="pre">;</span> <span class="pre">tail</span> <span class="pre">-f</span> <span class="pre">/var/log/restnoded/restnoded.log</span></code></p>
</li>
<li><p class="first">Review the logs to make sure there aren’t any errors or issues with
your updated file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Keep this SSH session open to monitor your logs.
It’s easier to have one window for logs and a separate one for issuing commands.</p>
</div>
</li>
<li><p class="first">You should have something like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span><span class="o">/</span><span class="n">hello_world</span><span class="o">.</span><span class="n">js</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">config</span><span class="p">:</span> <span class="p">[</span><span class="n">RestWorker</span><span class="p">]</span> <span class="o">/</span><span class="n">ilxe_lab</span><span class="o">/</span><span class="n">hello_world</span> <span class="n">has</span> <span class="n">started</span><span class="o">.</span> <span class="n">Name</span><span class="p">:</span><span class="n">HelloWorld</span>
</pre></div>
</div>
</li>
<li><p class="first">You can now test your updated extension with the following commands:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
<p>The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">World!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">Tue,</span> <span class="pre">17</span> <span class="pre">Oct</span> <span class="pre">2017</span> <span class="pre">13:33:45</span> <span class="pre">GMT</span> <span class="pre">-</span> <span class="pre">info:</span> <span class="pre">DEBUG:</span> <span class="pre">HelloWorld</span> <span class="pre">-</span> <span class="pre">onGet</span> <span class="pre">request</span></code></p>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;name&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">iControl</span> <span class="pre">LX</span> <span class="pre">Lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">46</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">46</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">the</span> <span class="n">extracted</span> <span class="n">name</span> <span class="ow">is</span> <span class="p">:</span> <span class="n">iControl</span> <span class="n">LX</span> <span class="n">Lab</span>
</pre></div>
</div>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;other&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this (the name parameter wasn’t found in
the POST payload):</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">World!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">24</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;other&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">24</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">no</span> <span class="n">name</span> <span class="n">parameter</span> <span class="n">provided</span><span class="o">...</span> <span class="n">using</span> <span class="n">default</span> <span class="n">value</span>
</pre></div>
</div>
</li>
</ol>
<p>We now have an iControl LX extension that is able to handle <code class="docutils literal notranslate"><span class="pre">GET</span></code> and <code class="docutils literal notranslate"><span class="pre">POST</span></code>
requests as well as provide debugging information.</p>
</div>
<div class="section" id="task-2-update-our-icontrol-lx-extension-perform-a-rest-api-call">
<h2>Task 2 - Update our iControl LX Extension - Perform a REST API Call<a class="headerlink" href="#task-2-update-our-icontrol-lx-extension-perform-a-rest-api-call" title="Permalink to this headline">¶</a></h2>
<p>Right now, our iControl LX extension provides a default message that is set at
the beginning of our code. If this “content” is owned by someone else, it may
be inefficient to have it directly in the code. Let’s see how we could leverage
an HTTP request to retrieve our default message.</p>
<p>For this task, we will do 3 things:</p>
<ul class="simple">
<li>Add the <code class="docutils literal notranslate"><span class="pre">http</span></code> module to our extension</li>
<li>Add a new prototype <code class="docutils literal notranslate"><span class="pre">onStart</span></code> to our code</li>
<li>Perform an HTTP request to GitHub to retrieve our default message</li>
</ul>
<p>Perform the following tasks to complete this task:</p>
<ol class="arabic">
<li><p class="first">To add the http module to our extension, we need to add the following at the
top of your code</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Add this below this existing line:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">The prototype <code class="docutils literal notranslate"><span class="pre">onStart</span></code> is something you can leverage to do some
processing when your iControl LX extension is loaded in <code class="docutils literal notranslate"><span class="pre">restnoded</span></code>. It
is triggered only once, when your extension is loaded. It’s a good prototype
to leverage to retrieve our default message.</p>
</li>
<li><p class="first">Under the line <code class="docutils literal notranslate"><span class="pre">HelloWorld.prototype.isPublic</span> <span class="pre">=</span> <span class="pre">true;</span></code>, add the following
code:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Perform worker start functions</span>
<span class="cm"> */</span>

<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onStart</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">success</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onStart request&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
  <span class="s2">&quot;hostname&quot;</span><span class="o">:</span> <span class="s2">&quot;s3-eu-west-1.amazonaws.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;port&quot;</span><span class="o">:</span> <span class="mi">80</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;/nicolas-labs/helloworld_resp.json&quot;</span><span class="p">,</span>
  <span class="s2">&quot;headers&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;cache-control&quot;</span><span class="o">:</span> <span class="s2">&quot;no-cache&quot;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">chunks</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">chunk</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">chunks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">chunks</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onStart - the default message body is: &quot;</span> <span class="o">+</span> <span class="nx">body</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">DEFAULT_MSG</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onStart - the default message is: &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">success</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">The purpose of this code is to retrieve the file
<a class="reference external" href="http://s3-eu-west-1.amazonaws.com/nicolas-labs/helloworld_resp.json">helloworld_resp</a>.</p>
</li>
<li><p class="first">This file will give us the default payload we should return when we receive
a request.</p>
</li>
<li><p class="first">Make sure you save your updated file. Then run the following
command:</p>
<p><code class="docutils literal notranslate"><span class="pre">bigstart</span> <span class="pre">restart</span> <span class="pre">restnoded</span> <span class="pre">;</span> <span class="pre">tail</span> <span class="pre">-f</span> <span class="pre">/var/log/restnoded/restnoded.log</span></code></p>
</li>
<li><p class="first">Review the logs to make sure there aren’t any errors or issues with
your updated file.</p>
<p>You should have something like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span><span class="o">/</span><span class="n">hello_world</span><span class="o">.</span><span class="n">js</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onStart</span> <span class="n">request</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">config</span><span class="p">:</span> <span class="p">[</span><span class="n">RestWorker</span><span class="p">]</span> <span class="o">/</span><span class="n">ilxe_lab</span><span class="o">/</span><span class="n">hello_world</span> <span class="n">has</span> <span class="n">started</span><span class="o">.</span> <span class="n">Name</span><span class="p">:</span><span class="n">HelloWorld</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onStart</span> <span class="o">-</span> <span class="n">the</span> <span class="n">default</span> <span class="n">message</span> <span class="n">body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Congratulations on your lab!&quot;</span> <span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">You can now test your updated extension with the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Congratulations</span> <span class="pre">on</span> <span class="pre">your</span> <span class="pre">lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">Tue,</span> <span class="pre">17</span> <span class="pre">Oct</span> <span class="pre">2017</span> <span class="pre">13:33:45</span> <span class="pre">GMT</span> <span class="pre">-</span> <span class="pre">info:</span> <span class="pre">DEBUG:</span> <span class="pre">HelloWorld</span> <span class="pre">-</span> <span class="pre">onGet</span> <span class="pre">request</span></code></p>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;name&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">iControl</span> <span class="pre">LX</span> <span class="pre">Lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">40</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">40</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">the</span> <span class="n">extracted</span> <span class="n">name</span> <span class="ow">is</span> <span class="p">:</span> <span class="n">iControl</span> <span class="n">LX</span> <span class="n">Lab</span>
</pre></div>
</div>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;other&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this (the name parameter wasn’t found in
the <code class="docutils literal notranslate"><span class="pre">POST</span></code> payload):</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Congratulations</span> <span class="pre">on</span> <span class="pre">your</span> <span class="pre">lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">38</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;other&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">38</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">no</span> <span class="n">name</span> <span class="n">parameter</span> <span class="n">provided</span><span class="o">...</span> <span class="n">using</span> <span class="n">default</span> <span class="n">value</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="task-3-take-a-5-minute-break">
<h2>Task 3 - Take a 5 minute break!<a class="headerlink" href="#task-3-take-a-5-minute-break" title="Permalink to this headline">¶</a></h2>
<p>Congratulations!!!! You’ve just modified the behavior of the F5 iControl LX
extension. Now take a moment to think about what workflows you could implement
to make life easier.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lab 4.2 - Updating the HelloWorld iControl LX Extension</a><ul>
<li><a class="reference internal" href="#task-1-update-our-icontrol-lx-extension-handle-post-requests">Task 1 - Update our iControl LX Extension - Handle POST Requests</a></li>
<li><a class="reference internal" href="#task-2-update-our-icontrol-lx-extension-perform-a-rest-api-call">Task 2 - Update our iControl LX Extension - Perform a REST API Call</a></li>
<li><a class="reference internal" href="#task-3-take-a-5-minute-break">Task 3 - Take a 5 minute break!</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../class1.html">Class 1 - F5 iControl LX extensions</a><ul>
  <li><a href="module4.html">Module 4 - Installing the HelloWorld extension</a><ul>
      <li>Previous: <a href="lab1.html" title="previous chapter">Lab 4.1 - Creating the HelloWorld iControl LX Extension</a></li>
      <li>Next: <a href="lab3.html" title="next chapter">Lab 4.3 - Create a New iControl LX Extension RPM</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/class1/module4/lab2.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, F5 Networks.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../../_sources/class1/module4/lab2.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>