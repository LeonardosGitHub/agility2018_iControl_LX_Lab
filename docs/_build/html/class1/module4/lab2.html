<!DOCTYPE html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lab 4.2 - Updating the HelloWorld iControl LX Extension &#8212; Single Call Security iControl LX REST API Lab  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 4.3 - Create a New iControl LX Extension RPM" href="lab3.html" />
    <link rel="prev" title="Lab 4.1 - Creating the HelloWorld iControl LX Extension" href="lab1.html" />
<!--
# Copyright 2017 F5 Networks
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
-->
<link href="https://cdn.f5.com/favicon.ico" rel="icon">
<script src="https://use.fontawesome.com/21fb8a09c3.js"></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head><body>
  <div class="container-fluid">
  <div class="row corp-header">
    <div class="container corp-header">
      <div class="container corp-menu">
        <ul>
          <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
          <li><a href="https://support.f5.com">Support</a></li>
          <li><a href="https://devcentral.f5.com">Community</a></li>
          <li><a href="https://github.com/F5Networks">GitHub</a></li>
          <li><a href="https://f5.com/about-us/careers">Careers</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row pageHeader">
    <div class="container stat">
      <div class="col-xs-12 stat">
        <a class="internalLink" href="https://f5.com">
          <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44" alt="F5 Networks" title="F5 Networks" border="0">
        </a>
        <ul id="MainMenu" class="main-menu">
          <li>
            <a href="#">Products
              <span class="indicator"><span class="arrow-up"></span></span>
            </a>

            <div class="menu-panel soft-hide" id="ProductsSubmenu">
              <div class="container">
                <ul class="submenu col-sm-11">
                  <li class="third"><span class="a-mm-h">BIG-IP Controllers</span>
                    <ul>
                      <li><a href="/products/connectors/cf-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 BIG-IP Controller for Cloud Foundry</a></li>
                      <li><a href="/products/connectors/k8s-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 BIG-IP Controller for Kubernetes/OpenShift</a></li>
                      <li><a href="/products/connectors/marathon-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 BIG-IP Controller for Marathon</a></li>
                    </ul>
                    <!-- unnecessary right now, we have them all listed>
                      <span class="seemore"><a data-link-type="Nav: Mega" href="/products/connectors">See all </a></span><-->
                    <span class="a-mm-h">Application Services Proxy</span>
                    <ul>
                      <li><a href="/products/asp/latest" data-link-type="Nav: Mega">F5 Application Services Proxy</a></li>
                      <li><a href="/products/connectors/f5-kube-proxy/latest" data-link-type="Nav: Mega">F5-kube-proxy</a></li>
                      <li><a href="/products/connectors/marathon-asp-ctlr/latest" data-link-type="Nav: Mega">F5 ASP Controller for Marathon</a></li>
                    </ul>
                    <!-- unnecessary>
                    <span class="seemore"><a href="/products/asp/latest">See all </a></span>
                    --->
                  </li>
                  <li class="divider"></li>
                  <li class="third"><span class="a-mm-h">OpenStack</span>
                    <ul>
                      <li><a href="/products/openstack/agent/latest" data-link-type="Nav: Mega">F5 Agent - OpenStack Neutron</a></li>
                      <li><a href="/products/openstack/lbaasv2-driver/latest" data-link-type="Nav: Mega">F5 Driver - OpenStack LBaaS</a></li>
                      <li><a href="/products/openstack/heat-plugins/latest" data-link-type="Nav: Mega">F5 Plugins - OpenStack Heat</a></li>
                     </ul>
                    <!--
                    <span class="seemore"><a href="/products/index.html">See all </a></span>
                    --->
                  </li>
                  <li class="divider"></li>
                  <li class="third"><span class="a-mm-h">Orchestration Templates</span>
                  <ul>
                    <li><a href="https://github.com/F5Networks/f5-aws-cloudformation" target="_blank">F5 Templates for AWS CloudFormation</a> </li>
                    <li><a href="https://github.com/F5Networks/f5-azure-arm-templates" target="_blank">F5 Templates for Azure ARM</a> </li>
                    <li><a href="https://github.com/F5Networks/f5-google-gdm-templates" target="_blank">F5 Templates for Google Cloud Deployment Manager</a> </li>
                    <li><a href="/products/templates/openstack-heat/latest" data-link-type="Nav: Mega">F5 Templates for OpenStack Heat</a></li>
                  </ul>
                    <!--
                    <span class="seemore"><a href="/products/index.html">See all </a></span>
                    --->
                </ul>
              </div>
            </div>
          </li>
          <li>
            <a href="#">Cloud & Container Integrations
              <span class="indicator"><span class="arrow-up"></span></span>
            </a>

            <div class="menu-panel soft-hide" id="ContainersSubmenu">
              <div class="container">
                <ul class="submenu col-sm-11">
                    <!--- HIDE, ALL ARE CURRENTLY DISPLAYED>
                    <span class="seemore"><a data-link-type="Nav: Mega" href="/containers/latest/">See all </a></span>
                    --->
                  <li class="third"><span class="a-mm-h">Clouds</span>
                    <ul>
                      <li><a href="/cloud/public/v1" data-link-type="Nav: Mega">AWS</a></li>
                      <li><a href="/cloud/public/v1" data-link-type="Nav: Mega">Azure</a></li>
                      <li><a href="/cloud/public/v1" data-link-type="Nav: Mega">Google Cloud</a></li>
                      <li><a href="/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                    </ul>
                    <!-- unnecessary right now>
                    <span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span>
                    <-->
                  <li class="divider"></li>
                  <li class="third"><span class="a-mm-h">Containers</span>
                    <ul>
                      <li><a href="/containers/latest/cloudfoundry/" data-link-type="Nav: Mega">Cloud Foundry</a> </li>
                      <li><a href="/containers/latest/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a></li>
                      <li><a href="/containers/latest/marathon/" data-link-type="Nav: Mega">Mesos Marathon</a></li>
                      <li><a href="/containers/latest/openshift/" data-link-type="Nav: Mega">OpenShift</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </li>
          <li>
            <a href="#">Resources
              <span class="indicator"><span class="arrow-up"></span></span>
            </a>
            <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
              <div class="container">
                <ul class="submenu col-sm-11">
                  <li class="third">
                    <span class="a-mm-h">Downloads</span>
                    <ul>
                      <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/" class="internalLink">Docker Hub</a></li>
                      <li><a target="_blank" data-link-type="Nav: Mega" href="https://store.docker.com/images/f5networks-asp" class="internalLink">Docker Store</a></li>
                    </ul>
                    <span class="a-mm-h">OpenSource</span>
                  <ul>
                    <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks" class="internalLink">F5Networks on GitHub</a></li>
                    <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5DevCentral" class="internalLink">F5DevCentral on GitHub</a></li>
                  </ul>
                    </li>
                  <li class="divider"></li>
                  <li class="third">
                  <span class="a-mm-h">Training & Labs</span>
                   <ul>
                  <li><p>Learn how to get the most out of the F5 platform</p></li>
                    <li><a href="/training/community">Community</a></li>
                  </ul>
                  </li>
                  <li class="divider"></li>
                  
                  <li class="third">
                    <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega">F5 University</a>
                    <ul>
                      <li>
                        <p>Get up to speed with free self-paced courses</p>
                      </li>
                    </ul>
                    <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                    <ul>
                      <li>
                        <p>Join the community of 250,000+ technical peers</p>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div> <!-- /container-fluid -->

  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-3 col-md-3 sidebartoc">
         <h4><a href="../../">Single Call Security iControl LX REST API Lab </a></h4>
  <p class="caption">
   <span class="caption-text">Current Page</span>
  </p>
  <ul>
<li><a class="reference internal" href="#">Lab 4.2 - Updating the HelloWorld iControl LX Extension</a><ul>
<li><a class="reference internal" href="#task-1-update-our-icontrol-lx-extension-handle-post-requests">Task 1 - Update our iControl LX Extension - Handle POST Requests</a></li>
<li><a class="reference internal" href="#task-2-update-our-icontrol-lx-extension-perform-a-rest-api-call">Task 2 - Update our iControl LX Extension - Perform a REST API Call</a></li>
<li><a class="reference internal" href="#task-3-take-a-5-minute-break">Task 3 - Take a 5 minute break!</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lab1.html"
                        title="previous chapter">Lab 4.1 - Creating the HelloWorld iControl LX Extension</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lab3.html"
                        title="next chapter">Lab 4.3 - Create a New iControl LX Extension RPM</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/class1/module4/lab2.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <form class="search" action="../../search.html" method="get">
    <div>
      <input type="text" name="q" placeholder="Search" style="padding-left: 6px;"/>
      <!-- <input type="submit" value="Go" style="margin-top: 4px;"/> -->
      <button type="submit" class="btn btn-primary btn-xs">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        
      </div>
      <div class="col-md-offset-3 col-sm-offset-3 main">
        <h4>
          <a href="/">Cloud Docs Home</a> &gt; <a href="../../index.html">Single Call Security iControl LX REST API Lab</a>
          <span class="right"><a href="../../genindex.html">Index</a></span>
        </h4>
        
  <div class="section" id="lab-4-2-updating-the-helloworld-icontrol-lx-extension">
<h1>Lab 4.2 - Updating the HelloWorld iControl LX Extension<a class="headerlink" href="#lab-4-2-updating-the-helloworld-icontrol-lx-extension" title="Permalink to this headline">¶</a></h1>
<p>Now that we have an initial version of our extension up and running, let’s enhance it by adding the following capabilities:</p>
<ul class="simple">
<li>Handle <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests</li>
<li>Add logging information. Always useful to add logging information to track
behaviour and help troubleshooting any issue</li>
<li>Send a REST API call to a 3rd system</li>
</ul>
<div class="section" id="task-1-update-our-icontrol-lx-extension-handle-post-requests">
<h2>Task 1 - Update our iControl LX Extension - Handle POST Requests<a class="headerlink" href="#task-1-update-our-icontrol-lx-extension-handle-post-requests" title="Permalink to this headline">¶</a></h2>
<p>Here we will add code to our extension to handle <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests,
as well as add some troubleshooting statements.</p>
<p>The first thing we must do is enable our <code class="docutils literal notranslate"><span class="pre">f5-logger</span></code>. This will log messages to
<cite>/var/log/restnoded/restnoded.log</cite>.</p>
<p>Perform the following steps to complete this task:</p>
<ol class="arabic">
<li><p class="first">Execute <code class="docutils literal notranslate"><span class="pre">vi</span> <span class="pre">/var/config/rest/iapps/HelloWorld/nodejs/hello_world.js</span></code> to
edit the file.</p>
</li>
<li><p class="first">Below the first comment,</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/**</span>
 <span class="o">*</span> <span class="n">A</span> <span class="n">simple</span> <span class="n">iControl</span> <span class="n">LX</span> <span class="n">Extension</span> <span class="n">that</span> <span class="n">handles</span> <span class="n">only</span> <span class="n">HTTP</span> <span class="n">GET</span>
 <span class="o">*/</span>
</pre></div>
</div>
<p>add the following: (<code class="docutils literal notranslate"><span class="pre">i,</span> <span class="pre">Paste,</span> <span class="pre">Enter</span></code> if you use <code class="docutils literal notranslate"><span class="pre">vi</span></code>)</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">logger</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;f5-logger&#39;</span><span class="p">).</span><span class="nx">getInstance</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">DEBUG</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Save the changes (<code class="docutils literal notranslate"><span class="pre">ESC</span> <span class="pre">ESC</span> <span class="pre">:w</span></code> if you use <code class="docutils literal notranslate"><span class="pre">vi</span></code>).</p>
</li>
<li><p class="first">Now we will be able to use the <code class="docutils literal notranslate"><span class="pre">logger</span></code> statement to print information to the
<cite>/var/log/restnoded/restnoded.log</cite> log file.  We can also enable/disable all
logging by changing the value of the DEBUG variable to false.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Here is an EXAMPLE of a logger statement (DO NOT PUT THIS INTO
YOUR CODE)</p>
<div class="last highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onGet request&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">We may also want to create a VARIABLE for our default JSON response of
<code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World!</span></code>. This way if we ever need to change it, we’ll only
need to change it in a single location.</p>
</li>
<li><p class="first">Under <code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">DEBUG</span> <span class="pre">=</span> <span class="pre">true;</span></code> add:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>
</pre></div>
</div>
<p>It should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;f5-logger&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInstance</span><span class="p">();</span>
<span class="n">var</span> <span class="n">DEBUG</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">var</span> <span class="n">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Next, let’s update your onGET prototype.  Right now you should have this:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onGet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span> <span class="p">}</span> <span class="p">));</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Replace this code with the following:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onGet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onGet request&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Here’s what we’ve done:</p>
<ul class="simple">
<li>Add a <code class="docutils literal notranslate"><span class="pre">logger</span></code> statement so that we can track when our extension is
called with a <code class="docutils literal notranslate"><span class="pre">GET</span></code> request</li>
<li>Replace our static response <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">value:</span> <span class="pre">&quot;Hello</span> <span class="pre">World!&quot;</span> <span class="pre">}</span></code> with our variable</li>
</ul>
</li>
<li><p class="first">Below our <code class="docutils literal notranslate"><span class="pre">onGet</span></code> prototype, we will now add an OnPost prototype to
handle <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests with our extension.</p>
<p>Add the following code below the <code class="docutils literal notranslate"><span class="pre">onGet</span></code> prototype:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">*handle onPost HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onPost</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">//we retrieve the payload sent with the POST request</span>
  <span class="kd">var</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">restOperation</span><span class="p">.</span><span class="nx">getBody</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost received Body is: &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">newState</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;\t&#39;</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="c1">//we extract the variable name from the payload</span>
  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">newState</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>

  <span class="c1">//if it&#39;s empty, we just print Hello World, otherwise Hello &lt;name&gt;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, the extracted name is : &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span><span class="p">}));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, no name parameter provided... using default value&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Let’s review the code we have now, it should look like this:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* A simple iControl LX Extension that handles only HTTP GET</span>
<span class="cm">*/</span>

<span class="kd">var</span> <span class="nx">logger</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;f5-logger&#39;</span><span class="p">).</span><span class="nx">getInstance</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">DEBUG</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>

<span class="kd">function</span> <span class="nx">HelloWorld</span><span class="p">()</span> <span class="p">{}</span>

<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">WORKER_URI_PATH</span> <span class="o">=</span> <span class="s2">&quot;ilxe_lab/hello_world&quot;</span><span class="p">;</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isPublic</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm">* handle onGet HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onGet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onGet request&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm">*handle onPost HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onPost</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//we retrieve the payload sent with the POST request</span>
 <span class="kd">var</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">restOperation</span><span class="p">.</span><span class="nx">getBody</span><span class="p">();</span>

 <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost received Body is: &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">newState</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;\t&#39;</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="c1">//we extract the variable name from the payload</span>
  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">newState</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>

  <span class="c1">//if it&#39;s empty, we just print Hello World, otherwise Hello &lt;name&gt;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, the extracted name is : &quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span><span class="p">}));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onPost request, no name parameter provided... using default value&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">restOperation</span><span class="p">.</span><span class="nx">setBody</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">DEFAULT_MSG</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">completeRestOperation</span><span class="p">(</span><span class="nx">restOperation</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm">* handle /example HTTP request</span>
<span class="cm">*/</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getExampleState</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;your_string&quot;</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">HelloWorld</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li>The lines starting with <code class="docutils literal notranslate"><span class="pre">//</span></code> are comments. It’s always good to comment your code to help people read/understand your code… the
more code there is, the more important it is to provide properly commented
code.</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">newState</span> <span class="pre">=</span> <span class="pre">restOperation.getBody();</span></code> With this statement we
retrieve the PAYLOAD that was sent in the POST request and we show this
payload in the following logger command.</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">name</span> <span class="pre">=</span> <span class="pre">newState.name;</span></code> With this statement we assign the name parameter’s
value (sent with the POST request) to the name variable.</li>
<li>The following if/else statement determines whether the variable name is
empty or not (if the POST payload didn’t contain a name parameter) and
depending on this will do the following:<ul>
<li>If the variable name is not empty: reply to the <code class="docutils literal notranslate"><span class="pre">POST</span></code> request with
Hello and the name of the user</li>
<li>If the variable name is empty: reply to the <code class="docutils literal notranslate"><span class="pre">POST</span></code> request with
<code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World!</span></code></li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Make sure you save your updated file.</p>
</li>
<li><p class="first">Time to test our code!  Open another SSH session to the BIG-IP and run the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">bigstart</span> <span class="pre">restart</span> <span class="pre">restnoded</span> <span class="pre">;</span> <span class="pre">tail</span> <span class="pre">-f</span> <span class="pre">/var/log/restnoded/restnoded.log</span></code></p>
</li>
<li><p class="first">Review the logs to make sure there aren’t any errors or issues with
your updated file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Keep this SSH session open to monitor your logs.
It’s easier to have one window for logs and a separate one for issuing commands.</p>
</div>
</li>
<li><p class="first">You should have something like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span><span class="o">/</span><span class="n">hello_world</span><span class="o">.</span><span class="n">js</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">config</span><span class="p">:</span> <span class="p">[</span><span class="n">RestWorker</span><span class="p">]</span> <span class="o">/</span><span class="n">ilxe_lab</span><span class="o">/</span><span class="n">hello_world</span> <span class="n">has</span> <span class="n">started</span><span class="o">.</span> <span class="n">Name</span><span class="p">:</span><span class="n">HelloWorld</span>
</pre></div>
</div>
</li>
<li><p class="first">You can now test your updated extension with the following commands:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
<p>The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">World!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">Tue,</span> <span class="pre">17</span> <span class="pre">Oct</span> <span class="pre">2017</span> <span class="pre">13:33:45</span> <span class="pre">GMT</span> <span class="pre">-</span> <span class="pre">info:</span> <span class="pre">DEBUG:</span> <span class="pre">HelloWorld</span> <span class="pre">-</span> <span class="pre">onGet</span> <span class="pre">request</span></code></p>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;name&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">iControl</span> <span class="pre">LX</span> <span class="pre">Lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">46</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">46</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">the</span> <span class="n">extracted</span> <span class="n">name</span> <span class="ow">is</span> <span class="p">:</span> <span class="n">iControl</span> <span class="n">LX</span> <span class="n">Lab</span>
</pre></div>
</div>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;other&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this (the name parameter wasn’t found in
the POST payload):</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">World!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">24</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;other&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Tue</span><span class="p">,</span> <span class="mi">17</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">24</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">no</span> <span class="n">name</span> <span class="n">parameter</span> <span class="n">provided</span><span class="o">...</span> <span class="n">using</span> <span class="n">default</span> <span class="n">value</span>
</pre></div>
</div>
</li>
</ol>
<p>We now have an iControl LX Extension that is able to handle <code class="docutils literal notranslate"><span class="pre">GET</span></code> and <code class="docutils literal notranslate"><span class="pre">POST</span></code>
requests as well as provide debugging information.</p>
</div>
<div class="section" id="task-2-update-our-icontrol-lx-extension-perform-a-rest-api-call">
<h2>Task 2 - Update our iControl LX Extension - Perform a REST API Call<a class="headerlink" href="#task-2-update-our-icontrol-lx-extension-perform-a-rest-api-call" title="Permalink to this headline">¶</a></h2>
<p>Right now, our iControl LX Extension provides a default message that is set at
the beginning of our code. If this “content” is owned by someone else, it may
be inefficient to have it directly in the code. Let’s see how we could leverage
an HTTP request to retrieve our default message.</p>
<p>For this task, we will do 3 things:</p>
<ul class="simple">
<li>Add the <code class="docutils literal notranslate"><span class="pre">http</span></code> module to our extension</li>
<li>Add a new prototype <code class="docutils literal notranslate"><span class="pre">onStart</span></code> to our code</li>
<li>Perform an HTTP request to GitHub to retrieve our default message</li>
</ul>
<p>Perform the following tasks to complete this task:</p>
<ol class="arabic">
<li><p class="first">To add the http module to our extension, we need to add the following at the
top of your code</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Add this below this existing line:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">DEFAULT_MSG</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">The prototype <code class="docutils literal notranslate"><span class="pre">onStart</span></code> is something you can leverage to do some
processing when your iControl LX Extension is loaded in <code class="docutils literal notranslate"><span class="pre">restnoded</span></code>. It
is triggered only once, when your extension is loaded. It’s a good prototype
to leverage to retrieve our default message.</p>
</li>
<li><p class="first">Under the line <code class="docutils literal notranslate"><span class="pre">HelloWorld.prototype.isPublic</span> <span class="pre">=</span> <span class="pre">true;</span></code>, add the following
code:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Perform worker start functions</span>
<span class="cm"> */</span>

<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">onStart</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">success</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onStart request&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;method&quot;</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
  <span class="s2">&quot;hostname&quot;</span><span class="o">:</span> <span class="s2">&quot;s3-eu-west-1.amazonaws.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;port&quot;</span><span class="o">:</span> <span class="mi">80</span><span class="p">,</span>
  <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;/nicolas-labs/helloworld_resp.json&quot;</span><span class="p">,</span>
  <span class="s2">&quot;headers&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;cache-control&quot;</span><span class="o">:</span> <span class="s2">&quot;no-cache&quot;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">chunks</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">chunk</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">chunks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">chunks</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onStart - the default message body is: &quot;</span> <span class="o">+</span> <span class="nx">body</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">DEFAULT_MSG</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">DEBUG</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">logger</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;DEBUG: HelloWorld - onStart - the default message is: &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">success</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">The purpose of this code is to retrieve the file
<a class="reference external" href="http://s3-eu-west-1.amazonaws.com/nicolas-labs/helloworld_resp.json">helloworld_resp</a>.</p>
</li>
<li><p class="first">This file will give us the default payload we should return when we receive
a request.</p>
</li>
<li><p class="first">Make sure you save your updated file. Then run the following
command:</p>
<p><code class="docutils literal notranslate"><span class="pre">bigstart</span> <span class="pre">restart</span> <span class="pre">restnoded</span> <span class="pre">;</span> <span class="pre">tail</span> <span class="pre">-f</span> <span class="pre">/var/log/restnoded/restnoded.log</span></code></p>
</li>
<li><p class="first">Review the logs to make sure there aren’t any errors or issues with
your updated file.</p>
<p>You should have something like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">finest</span><span class="p">:</span> <span class="p">[</span><span class="n">LoaderWorker</span><span class="p">]</span> <span class="n">triggered</span> <span class="n">at</span> <span class="n">path</span><span class="p">:</span>  <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">iapps</span><span class="o">/</span><span class="n">HelloWorld</span><span class="o">/</span><span class="n">nodejs</span><span class="o">/</span><span class="n">hello_world</span><span class="o">.</span><span class="n">js</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onStart</span> <span class="n">request</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">config</span><span class="p">:</span> <span class="p">[</span><span class="n">RestWorker</span><span class="p">]</span> <span class="o">/</span><span class="n">ilxe_lab</span><span class="o">/</span><span class="n">hello_world</span> <span class="n">has</span> <span class="n">started</span><span class="o">.</span> <span class="n">Name</span><span class="p">:</span><span class="n">HelloWorld</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">08</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onStart</span> <span class="o">-</span> <span class="n">the</span> <span class="n">default</span> <span class="n">message</span> <span class="n">body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Congratulations on your lab!&quot;</span> <span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">You can now test your updated extension with the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Congratulations</span> <span class="pre">on</span> <span class="pre">your</span> <span class="pre">lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">Tue,</span> <span class="pre">17</span> <span class="pre">Oct</span> <span class="pre">2017</span> <span class="pre">13:33:45</span> <span class="pre">GMT</span> <span class="pre">-</span> <span class="pre">info:</span> <span class="pre">DEBUG:</span> <span class="pre">HelloWorld</span> <span class="pre">-</span> <span class="pre">onGet</span> <span class="pre">request</span></code></p>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;name&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Hello</span> <span class="pre">iControl</span> <span class="pre">LX</span> <span class="pre">Lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">40</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">40</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">the</span> <span class="n">extracted</span> <span class="n">name</span> <span class="ow">is</span> <span class="p">:</span> <span class="n">iControl</span> <span class="n">LX</span> <span class="n">Lab</span>
</pre></div>
</div>
</li>
<li><p class="first">Run this command:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">-k</span> <span class="pre">-u</span> <span class="pre">admin:admin</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">-d</span> <span class="pre">'{&quot;other&quot;:&quot;iControl</span> <span class="pre">LX</span> <span class="pre">Lab&quot;}'</span> <span class="pre">https://10.1.1.245/mgmt/ilxe_lab/hello_world</span></code></p>
</li>
<li><p class="first">The console output should look like this (the name parameter wasn’t found in
the <code class="docutils literal notranslate"><span class="pre">POST</span></code> payload):</p>
<p><code class="docutils literal notranslate"><span class="pre">{&quot;value&quot;:&quot;Congratulations</span> <span class="pre">on</span> <span class="pre">your</span> <span class="pre">lab!&quot;}</span></code></p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">/var/log/restnoded/restnoded.log</span></code> output should look like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">38</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">received</span> <span class="n">Body</span> <span class="ow">is</span><span class="p">:</span> <span class="p">{</span>
<span class="s2">&quot;other&quot;</span><span class="p">:</span> <span class="s2">&quot;iControl LX Lab&quot;</span>
<span class="p">}</span>
<span class="n">Wed</span><span class="p">,</span> <span class="mi">18</span> <span class="n">Oct</span> <span class="mi">2017</span> <span class="mi">09</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">38</span> <span class="n">GMT</span> <span class="o">-</span> <span class="n">info</span><span class="p">:</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="n">HelloWorld</span> <span class="o">-</span> <span class="n">onPost</span> <span class="n">request</span><span class="p">,</span> <span class="n">no</span> <span class="n">name</span> <span class="n">parameter</span> <span class="n">provided</span><span class="o">...</span> <span class="n">using</span> <span class="n">default</span> <span class="n">value</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="task-3-take-a-5-minute-break">
<h2>Task 3 - Take a 5 minute break!<a class="headerlink" href="#task-3-take-a-5-minute-break" title="Permalink to this headline">¶</a></h2>
<p>Congratulations!!!! You’ve just modified the behavior of the F5 iControl LX
Extension. Now take a moment to think about what workflows you could implement
to make life easier.</p>
</div>
</div>


        
		     <div class="row next-prev-btn-row">
           <div class="col-lg-12">
           
		        <a href="lab1.html" title="Lab 4.1 - Creating the HelloWorld iControl LX Extension" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
           
           
              <a href="lab3.html" title="Lab 4.3 - Create a New iControl LX Extension RPM" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
           
		     </div>
         </div>
        
      </div>
    </div>
  </div>


      <div class="container-fluid">
      <div class="row">
        <div class="content-fluid pre-footer">
          <div class="blocks-container">
            <div class="block">
              <h3>Support Programs</h3>
              <p>Regionally located support centers enable F5 to provide support in a number of languages through native-speaking support engineers.</p>
              <a class="btn internalLink" data-ng-href="https://f5.com/support/support-offerings" target="_blank" href="https://f5.com/support/support-offerings">See more
                <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
              </a>
            </div>
            <div class="block">
              <h3>Contact Support</h3>
              <p>
                North America: 1-888-882-7535<br>
                Outside North America: 800-11-275-435
              </p>
              <a class="btn internalLink" data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" href="https://f5.com/about-us/contact#regional-support">Local Support Numbers
                <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
              </a>
            </div>
            <div class="block">
              <h3>Feedback and Help</h3>
              <p>Have questions, suggestions, or just want to get something off your chest? Let us know.</p>
              <a class="btn" data-ui-sref="siteFeedback" target="_blank" href="https://support.f5.com/csp/siteFeedback">Leave feedback</a>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="footer">
          <div class="container">
            <div class="col-sm-3 col-md-2">
              <h4>About F5</h4>
              <ul>
                <li><a data-ng-href="https://f5.com/about-us/contact" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact" class="internalLink">Contact F5</a>
                </li>
                <li><a data-ng-href="https://f5.com/about-us/careers" target="_blank" data-link-type="footer" href="https://f5.com/about-us/careers" class="internalLink">Careers</a>
                </li>
              </ul>
            </div>
            <div class="col-sm-3 col-md-2">
              <h4>Education</h4>
              <ul>
                <li><a data-ng-href="https://f5.com/education/training" target="_blank" data-link-type="footer" href="https://f5.com/education/training" class="internalLink">Training</a>
                </li>
                <li><a data-ng-href="https://f5.com/education/certification" target="_blank" data-link-type="footer" href="https://f5.com/education/certification" class="internalLink">Certification</a>
                </li>
                <li><a data-ng-href="https://f5.com/education/training/free-courses" target="_blank" data-link-type="footer" href="https://f5.com/education/training/free-courses" class="internalLink">Free Online Training</a>
                </li>
              </ul>
            </div>

            <div class="col-sm-3 col-md-2">
              <h4>F5 sites</h4>
              <ul>
              <li><a data-ng-href="https://f5.com" target="_blank" data-link-type="footer" href="https://f5.com" class="internalLink">F5.com</a>
              </li>
              <li><a data-ng-href="https://devcentral.f5.com" target="_blank" data-link-type="footer" href="https://devcentral.f5.com" class="internalLink">Community</a>
              </li>
              <li><a data-ng-href="https://partners.f5.com" target="_blank" data-link-type="footer" href="https://partners.f5.com" class="internalLink">Partners</a>
              </li>
          </ul>
      </div>

      <div class="col-sm-3 col-md-2">
          <h4>Support Tasks</h4>
          <ul>
              <li><a data-ui-sref="mySupport.createServiceRequest" data-link-type="footer" href="https://support.f5.com/csp/my-support/service-request">Create Service Request </a>
              </li>
              <li><a data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact#regional-support" class="internalLink">Contact Support</a>
              </li>
              <li><a data-ui-sref="siteFeedback" target="_blank" data-link-type="footer" href="https://support.f5.com/csp/siteFeedback">Leave feedback [+]</a>
              </li>
          </ul>
      </div>

      <div class="col-xs-12 col-md-3 right">
          <h4>Connect with us</h4>
          <ul class="social_icons">
              <li><a href="//twitter.com/f5networks" target="_blank" data-name="twitter" data-type="" data-prefix="social" data-utf="E032" title="Twitter" class="externalLink"><i class="icon-1x icon-twitter icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a href="//www.linkedin.com/companies/f5-networks" target="_blank" class="linkedin externalLink" title="LinkedIn"><i class="icon-1x icon-linkedin icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a href="//www.facebook.com/f5networksinc" target="_blank" class="facebook externalLink" title="Facebook"><i class="icon-1x icon-facebook icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a href="//www.youtube.com/f5networksinc" target="_blank" class="youtube externalLink" title="YouTube"><i class="icon-1x icon-youtube icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a data-ng-href="https://devcentral.f5.com" target="_blank" class="devcentral internalLink" title="DevCentral" href="https://devcentral.f5.com"><i class="icon-1x icon-dc-pos icon-inverse-circle" data-link-type="footer"></i></a></li>
          </ul>
      </div>

      <div class="content-fluid left">
          <div class="col-xs-12">
              <p>
                  © Copyright <span class="ng-binding">2017</span> by F5 Networks, Inc. |
                  <a data-ng-href="https://f5.com/about-us/policies" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies" class="internalLink">Policies</a> |
                  <a data-ng-href="https://f5.com/about-us/policies/trademarks" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies/trademarks" class="internalLink">Trademarks</a>
              </p>
          </div>
      </div>
  </div>
</div>
  </div>
</div>

  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  </body>
</html>